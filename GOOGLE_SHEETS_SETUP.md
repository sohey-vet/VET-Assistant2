# Googleスプレッドシート連携設定ガイド

VET-Assistant2でGoogleスプレッドシートに投稿スケジュールを自動アップロードする設定手順です。

## 🚀 事前準備

### 1. Google Cloud Console でプロジェクト作成

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. 新しいプロジェクトを作成（例：`vet-assistant-sheets`）
3. プロジェクトを選択

### 2. Google Sheets API を有効化

1. 左メニューから「APIとサービス」→「ライブラリ」
2. 「Google Sheets API」を検索
3. 「有効にする」をクリック
4. 「Google Drive API」も同様に有効化

### 3. サービスアカウント作成

1. 「APIとサービス」→「認証情報」
2. 「認証情報を作成」→「サービスアカウント」
3. サービスアカウント情報を入力：
   - 名前：`vet-assistant-uploader`
   - 説明：`VET-Assistant2からのスプレッドシートアップロード用`
4. 「作成して続行」をクリック
5. ロールは設定せずに「完了」

### 4. 認証キー（JSON）をダウンロード

1. 作成したサービスアカウントをクリック
2. 「キー」タブ→「鍵を追加」→「新しい鍵を作成」
3. 形式：「JSON」を選択
4. 「作成」→JSONファイルがダウンロード
5. ファイルを安全な場所に保存（例：`credentials.json`）

## 📊 Googleスプレッドシート準備

### 1. 新しいスプレッドシートを作成

1. [Google Sheets](https://sheets.google.com/) で新しいスプレッドシートを作成
2. わかりやすい名前を付ける（例：`VET投稿スケジュール`）

### 2. サービスアカウントに共有権限を付与

1. スプレッドシート右上の「共有」ボタンをクリック
2. ダウンロードしたJSONファイル内の `client_email` をコピー
3. そのメールアドレスを「ユーザーやグループを追加」に入力
4. 権限：「編集者」を選択
5. 「送信」をクリック

### 3. スプレッドシートURLをコピー

1. ブラウザのアドレスバーからURLをコピー
2. 形式：`https://docs.google.com/spreadsheets/d/[スプレッドシートID]/edit#gid=0`

## 🛠️ VET-Assistant2での設定

### 1. 必要ライブラリのインストール

```bash
pip install -r requirements.txt
```

### 2. アプリでの設定手順

1. VET-Assistant2を起動
2. 「Googleスプレッドシート連携」セクションで：
   - 「認証設定」ボタンをクリック
   - ダウンロードしたJSONファイルを選択
   - 認証が成功すると「認証済み」と表示
3. 「スプレッドシートURL」にコピーしたURLを貼り付け

## 📝 使用方法

### 投稿生成とアップロード

1. 通常通り投稿を生成
2. 生成完了後、「📤 Googleシートにアップロード」ボタンが有効化
3. ボタンをクリックしてアップロード実行

### アップロード内容

- **シート名**: `投稿スケジュール_YYYY年MM月DD日`
- **列構成**:
  - 投稿日時
  - 投稿内容
  - 文字数
  - 投稿済み（未投稿/投稿済み/下書きから選択可能）
  - 備考
  - ハッシュタグ

## 🔒 セキュリティ注意事項

1. **認証JSONファイルの管理**:
   - 他人と共有しない
   - GitHubなどの公開リポジトリにアップロードしない
   - 定期的にローテーションを検討

2. **スプレッドシートの共有**:
   - 必要最小限の権限のみ付与
   - 不要になったアクセス権は削除

## 🐛 トラブルシューティング

### よくあるエラーと解決方法

1. **「認証に失敗しました」**
   - JSONファイルが正しいか確認
   - Google Sheets APIが有効化されているか確認

2. **「スプレッドシートにアクセスできません」**
   - サービスアカウントに共有権限が付与されているか確認
   - URLが正しいか確認

3. **「アップロードに失敗しました」**
   - インターネット接続を確認
   - Google Sheets APIの利用制限に達していないか確認

## 📞 サポート

問題が解決しない場合は、以下の情報と共にお問い合わせください：
- エラーメッセージの詳細
- 実行環境（Windows バージョン、Python バージョン）
- 実行したステップ

---

**注意**: このガイドの設定により、VET-Assistant2で生成した投稿スケジュールが自動的にGoogleスプレッドシートに送信され、投稿管理が効率化されます。